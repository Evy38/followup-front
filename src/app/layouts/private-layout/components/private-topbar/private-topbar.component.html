<header class="topbar" aria-label="Barre dâ€™actions">
  @if (topbarContext$ | async; as ctx) {

    <!-- CONTENU CONTEXTUEL -->
    <div class="topbar__left">

      @if (ctx === 'annonces') {
        <form class="topbar__search" (ngSubmit)="onFiltreChange()" autocomplete="off">
          <input
            type="text"
            [(ngModel)]="filtre.poste"
            name="poste"
            placeholder="Type de poste recherchÃ©"
            aria-label="Type de poste recherchÃ©"
          />
          <div class="ville-autocomplete" style="position:relative;flex:1;min-width:180px;">
            <input
              type="text"
              [ngModel]="villeInput"
              (ngModelChange)="onVilleInputChange($event)"
              (focus)="showVilleList = !!filteredVilles.length"
              (blur)="onVilleBlur()"
              name="ville"
              placeholder="Ville"
              aria-label="Ville"
              autocomplete="off"
              style="width:100%;height:44px;padding:0 18px;border-radius:16px;border:none;font-size:16px;background:#fff;box-shadow:0 1px 4px rgba(90,80,180,0.04);"
            />
            <ul *ngIf="showVilleList" class="ville-list" style="position:absolute;z-index:1000;left:0;right:0;top:48px;background:#fff;border-radius:0 0 12px 12px;box-shadow:0 2px 8px rgba(90,80,180,0.13);margin:0;padding:0;list-style:none;max-height:200px;overflow:auto;">
              <li *ngFor="let ville of filteredVilles" (mousedown)="onVilleSelect(ville)" style="padding:10px 18px;cursor:pointer;">
                {{ ville }}
              </li>
            </ul>
          </div>
          <select [(ngModel)]="filtre.contrat" name="contrat" aria-label="Type de contrat">
            <option value="">Type de contrat</option>
            <option *ngFor="let contrat of contrats" [value]="contrat.value">{{ contrat.label }}</option>
          </select>
          <button type="submit" class="search-btn">Rechercher</button>
        </form>
      } @else {
        <div class="topbar__tabs">
          <button type="button" class="tab active">Emails / Relances</button>
          <button type="button" class="tab">Favoris</button>
          <button type="button" class="tab">Mes docs</button>
        </div>
      }

    </div>

    <!-- ACTIONS GLOBALES -->
    <div class="topbar__right">
      <button type="button" class="icon-btn" aria-label="Notifications">
        ðŸ””
      </button>
    </div>

  }
</header>
