<header class="topbar" aria-label="Barre d'actions" [attr.data-context]="topbarContext$ | async">
  @if (topbarContext$ | async; as ctx) {

    <!-- CONTENU CONTEXTUEL -->
    <div class="topbar__left">

      @if (ctx === 'annonces') {
        <form class="topbar__search" (ngSubmit)="onFiltreChange()" autocomplete="off">
          <input
            type="text"
            [(ngModel)]="filtre.poste"
            name="poste"
            placeholder="Type de poste recherchÃ©"
            aria-label="Type de poste recherchÃ©"
            class="search-input"
          />
          
          <div class="ville-autocomplete">
            <input
              type="text"
              [ngModel]="villeInput"
              (ngModelChange)="onVilleInputChange($event)"
              (focus)="showVilleList = !!filteredVilles.length"
              (blur)="onVilleBlur()"
              name="ville"
              placeholder="Ville"
              aria-label="Ville"
              autocomplete="off"
              class="search-input"
            />
            <ul *ngIf="showVilleList" class="ville-list">
              <li *ngFor="let ville of filteredVilles" 
                  (mousedown)="onVilleSelect(ville)">
                {{ ville }}
              </li>
            </ul>
          </div>
          
          <button type="submit" class="search-btn">Rechercher</button>
        </form>
      } @else {
        <div class="topbar__tabs">
          <button type="button" class="tab active">Emails / Relances </button>
          <button type="button" class="tab">Favoris</button>
          <button type="button" class="tab">Mes docs</button>
        </div>
      }

    </div>

    <!-- ACTIONS GLOBALES -->
    <div class="topbar__right">
      <button type="button" class="icon-btn" aria-label="Notifications">
        ðŸ””
      </button>
    </div>

  }
</header>