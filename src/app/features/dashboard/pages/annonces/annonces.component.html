<app-private-topbar [villes]="villes" [postes]="postes" (filtreChange)="onFiltreChange($event)">
</app-private-topbar>

<section class="annonces">
  <p *ngIf="loading">Chargement des annoncesâ€¦</p>
  <p *ngIf="error">{{ error }}</p>

  <div *ngIf="!loading && !error && filteredJobs.length === 0" class="no-results">
    <p>Aucune annonce ne correspond Ã  vos critÃ¨res de recherche.</p>
    <p class="hint">Essayez de modifier vos filtres ou d'Ã©largir votre recherche.</p>
  </div>

  <p *ngIf="!loading && !error && filteredJobs.length > 0" class="results-count">
    {{ filteredJobs.length }} annonce(s) trouvÃ©e(s)
  </p>

  <ul *ngIf="!loading && !error">
    <li *ngFor="let job of filteredJobs; trackBy: trackByJobId" class="job-card">
      <div class="job-header">
        <h3>{{ job.title }}</h3>
        <!-- âœ… Badge Ã  droite du titre si disponible -->
        <span *ngIf="job.contractType && job.contractType !== 'Non spÃ©cifiÃ©'" 
              class="contract-badge"
              [class.badge-cdi]="job.contractType === 'CDI'"
              [class.badge-cdd]="job.contractType === 'CDD'"
              [class.badge-interim]="job.contractType === 'IntÃ©rim'">
          {{ job.contractType }}
        </span>
      </div>
      
      <p><strong>{{ job.company }}</strong></p>
      <p>{{ job.location }}</p>
      
      <p *ngIf="job.salaryMin || job.salaryMax">
        ðŸ’° Salaire :
        {{ job.salaryMin ?? 'â€”' }} â‚¬ â€“ {{ job.salaryMax ?? 'â€”' }} â‚¬
      </p>
      
      <div class="job-actions">
        <a [href]="job.redirectUrl" target="_blank" rel="noopener noreferrer">
          Voir l'annonce
        </a>
        <button (click)="onCandidated(job)" [disabled]="job._candidated">
          {{ job._candidated ? 'DÃ©jÃ  candidatÃ©' : 'J\'ai candidatÃ©' }}
        </button>
      </div>
    </li>
  </ul>
</section>