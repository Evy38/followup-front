<section class="annonces" (scroll)="onScroll($event)">
  @if (loading) {
    <p class="state">Chargement des annonces‚Ä¶</p>
  }
  @if (error) {
    <p class="state error">{{ error }}</p>
  }

  @if (!loading && !error && jobs.length === 0) {
    <div class="no-results">
      <p>Aucune annonce ne correspondent √† vos crit√®res de recherche.</p>
      <p class="hint">Essayez de modifier vos filtres ou d'√©largir votre recherche.</p>
    </div>
  }

  @if (!loading && !error && jobs.length > 0) {
    <p class="results-count">
      {{ jobs.length }} annonce(s) trouv√©e(s)
    </p>
  }

  @if (!loading && !error) {
    <ul class="job-list">
      @for (job of jobs; track job.externalId) {
        <li class="job-card">

      <header class="job-header">
        <h3 class="job-title">{{ job.title }}</h3>

        @if (job.contractType && job.contractType !== 'Non sp√©cifi√©') {
          <span
            class="contract-badge"
            [class.badge-cdi]="job.contractType === 'CDI'"
            [class.badge-cdd]="job.contractType === 'CDD'"
            [class.badge-interim]="job.contractType === 'Int√©rim'"
          >
            {{ job.contractType }}
          </span>
        }
      </header>

      <p class="company"><strong>{{ job.company }}</strong></p>
      <p class="location">{{ job.location }}</p>

      @if (job.salaryMin || job.salaryMax) {
        <p class="salary">
          üí∞ Salaire :
          {{ job.salaryMin ?? '‚Äî' }} ‚Ç¨ ‚Äì {{ job.salaryMax ?? '‚Äî' }} ‚Ç¨
        </p>
      }

      <div class="job-actions">
        <a
          [href]="job.redirectUrl"
          target="_blank"
          rel="noopener noreferrer"
          class="link"
        >
          Voir l'annonce
        </a>

        <button
          (click)="onCandidated(job)"
          [disabled]="job._candidated"
        >
          {{ job._candidated ? 'D√©j√† candidat√©' : 'J‚Äôai candidat√©' }}
        </button>
      </div>
        </li>
      }
    </ul>
  }

  <!-- Indicateur de chargement de la page suivante -->
  @if (loadingMore) {
    <div class="loading-more">
      <p class="state">Chargement d'autres annonces‚Ä¶</p>
    </div>
  }

  <!-- Message de fin de pagination -->
  @if (!loading && !loadingMore && jobs.length > 0 && !hasMore) {
    <div class="end-of-list">
      <p class="hint">Vous avez atteint la fin des r√©sultats</p>
    </div>
  }
</section>
